(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.r(t),e.d(t,{analyserNode:()=>k,audioCtx:()=>b,biquadFilter:()=>x,loadSoundFile:()=>L,lowshelfBiquadFilter:()=>A,pauseCurrentSound:()=>R,playCurrentSound:()=>C,setVolume:()=>j,setupWebaudio:()=>I});var r=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(r,")")};function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function i(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}var c=function(){return e=function e(t,n,r,o,a,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.x=n,this.y=r,this.maxX=o,this.maxY=a,this.divergence=i,this.fps=60,this.n=0,this.c=4,this.radius=2},t=[{key:"update",value:function(e){this.loop(e)}},{key:"loop",value:function(e){var t=this;this.c+=.01,this.radius+=.01;var n=this.n*this.dtr(this.divergence),r=this.c*Math.sqrt(this.n),o=r*Math.cos(n)+this.x,a=r*Math.sin(n)+this.y;o>=this.maxX&&a>=this.maxY&&(this.c=4,this.radius=2,this.n=0,this.ctx.clearRect(0,0,this.maxX,this.maxY));var i=e[this.n%e.length]/255*(this.maxY/8),c=this.n/5%360,s="hsl(".concat(c=(c+240)%360,", 100%, 50%)");this.drawCircle(o,a,i,s),this.n++,this.animationTimeout=setTimeout((function(){return t.loop(e)}),1e3/this.fps)}},{key:"dtr",value:function(e){return e*(Math.PI/180)}},{key:"drawCircle",value:function(e,t,n,r){this.ctx.save(),this.ctx.fillStyle=r,this.ctx.beginPath(),this.ctx.arc(e,t,n,0,2*Math.PI),this.ctx.closePath(),this.ctx.fill(),this.ctx.restore()}},{key:"stopAnimation",value:function(){clearTimeout(this.animationTimeout)}}],t&&a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}var h,f,d,y,v,g,m=function(){return e=function e(t,n,r,o,a,i,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.x=n,this.y=r,this.width=o,this.height=a,this.fillStyle=i,this.scale=c,this.fps=60},t=[{key:"update",value:function(e){this.drawSquare(e)}},{key:"drawSquare",value:function(){var e=this;this.ctx.save(),this.ctx.fillStyle=this.fillStyle,this.ctx.translate(this.x,this.y),this.ctx.scale(this.scale,this.scale),this.ctx.fillRect(0-this.width/2,0-this.height/2,this.width,this.height),this.ctx.restore(),this.scale+=.01,setTimeout((function(){return e.drawSquare()}),1e3/this.fps)}}],t&&l(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b,S,q,k,T,x,A,P=function(e,t){h=e.getContext("2d"),f=e.width,d=e.height,y=function(e,t,r,o,a,i){var c,s=e.createLinearGradient(0,0,0,a),l=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw i}}}}([{percent:0,color:"yellow"},{percent:.25,color:"orange"},{percent:.5,color:"coral"},{percent:1,color:"magenta"}]);try{for(l.s();!(c=l.n()).done;){var u=c.value;s.addColorStop(u.percent,u.color)}}catch(e){l.e(e)}finally{l.f()}return s}(h,0,0,0,d),v=t,g=new Uint8Array(v.fftSize/2)},E=Object.freeze({gain:.5,numSamples:256}),I=(new Uint8Array(E.numSamples/2),function(e){var t=window.AudioContext||window.webkitAudioContext;b=new t,S=new Audio,L(e),q=b.createMediaElementSource(S),(x=b.createBiquadFilter()).type="highshelf",(A=b.createBiquadFilter()).type="lowshelf",(k=b.createAnalyser()).fftSize=E.numSamples,(T=b.createGain()).gain.value=E.gain,q.connect(x),x.connect(A),A.connect(k),k.connect(T),T.connect(b.destination)}),L=function(e){S.src=e},C=function(){S.play()},R=function(){S.pause()},j=function(e){e=Number(e),T.gain.value=e},M=document.querySelector("#cb-gradient"),O=document.querySelector("#cb-bars"),F=document.querySelector("#cb-rays"),B=document.querySelector("#cb-lines"),G=document.querySelector("#cb-circles"),N=document.querySelector("#cb-phyllo"),D=document.querySelector("#cb-noise"),z=document.querySelector("#cb-invert"),V=document.querySelector("#cb-emboss"),W=document.querySelector("#cb-treble"),H=document.querySelector("#cb-bass"),U=document.querySelector("#sunset-select"),X=document.querySelector("#sunrise-select"),Y=document.querySelector("#night-select"),J=document.querySelector("#cb-shape"),$=document.querySelector("#info-visualizer"),_={showGradient:!0,showBars:!0,showRays:!0,showLines:!1,showCircles:!0,showPhyllo:!0,showSquares:!1,showNoise:!1,showInvert:!1,showEmboss:!1,playTreble:!1,playBass:!1,toggleWave:!1},K=Object.freeze({sound1:"media/softvibes.mp3"}),Q=!1,Z=!1,ee=function(){var e;console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat("rgba(".concat((e=function(){return 185*Math.random()+35})(),",").concat(e(),",").concat(e(),",1)"))),I(K.sound1),console.log(t);var n,r=document.querySelector("canvas");M.checked=_.showGradient,O.checked=_.showBars,G.checked=_.showCircles,D.checked=_.showNoise,F.checked=_.showRays,B.checked=_.showLines,N.checked=_.showPhyllo,J.checked=_.showSquares,(n=new XMLHttpRequest).onload=function(e){var t;try{t=JSON.parse(e.target.responseText)}catch(e){return document.querySelector("#output").innerHTML="BAD JSON",void console.error("Error parsing JSON:",e)}var n=t,r="";r+="<h2>".concat(n.title?n.title:"No title found","</h2>"),r+="<ol>".concat(n.audioFiles.map((function(e){return"<li>".concat(e,"</li>")})).join(""),"</ol>"),r+="<p>".concat(n.instructions,"</p>"),document.querySelector("#output").innerHTML=r},n.onerror=function(e){return console.log("In onerror - HTTP Status Code = ".concat(e.target.status))},n.open("GET","data/av-data.json"),n.send(),re(r),P(r,k),oe()},te=function(){Q?(x.frequency.setValueAtTime(1e3,b.currentTime),x.gain.setValueAtTime(25,b.currentTime)):x.gain.setValueAtTime(0,b.currentTime)},ne=function(){Z?(A.frequency.setValueAtTime(1e3,b.currentTime),A.gain.setValueAtTime(15,b.currentTime)):A.gain.setValueAtTime(0,b.currentTime)},re=function(e){var t=document.querySelector("#btn-fs"),n=document.querySelector("#btn-play");t.onclick=function(t){var n;console.log("goFullscreen() called"),(n=e).requestFullscreen?n.requestFullscreen():n.mozRequestFullscreen?n.mozRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()},n.onclick=function(e){console.log("audioCtx.state before = ".concat(b.state)),"suspended"==b.state&&b.resume(),console.log("audioCtx.state after = ".concat(b.state)),"no"==e.target.dataset.playing?(C(),e.target.dataset.playing="yes"):(R(),e.target.dataset.playing="no")};var r=document.querySelector("#slider-volume"),o=document.querySelector("#label-volume");r.oninput=function(e){j(e.target.value),o.innerHTML=Math.round(e.target.value/2*100)},r.dispatchEvent(new Event("input")),document.querySelector("#select-track").onchange=function(e){L(e.target.value),"yes"==n.dataset.playing&&n.dispatchEvent(new MouseEvent("click"))},U.addEventListener("change",(function(){this.checked&&(_.showGradient=!0,_.showBars=!1,_.showInvert=!1,_.showRays=!0,_.showCircles=!0,_.showLines=!0)})),X.addEventListener("change",(function(){this.checked&&(_.showGradient=!0,_.showInvert=!0,_.showBars=!0,_.showRays=!0,_.showCircles=!0,_.showLines=!1)})),Y.addEventListener("change",(function(){this.checked&&(_.showGradient=!1,_.showInvert=!1,_.showBars=!1,_.showRays=!1,_.showCircles=!0,_.showLines=!0)})),W.checked=Q,H.checked=Z,M.addEventListener("change",(function(){_.showGradient=this.checked})),O.addEventListener("change",(function(){_.showBars=this.checked})),F.addEventListener("change",(function(){_.showRays=this.checked})),B.addEventListener("change",(function(){_.showLines=this.checked})),G.addEventListener("change",(function(){_.showCircles=this.checked})),J.addEventListener("change",(function(){_.showSquares=this.checked})),N.addEventListener("change",(function(){_.showPhyllo=this.checked})),D.addEventListener("change",(function(){_.showNoise=this.checked})),z.addEventListener("change",(function(){_.showInvert=this.checked})),V.addEventListener("change",(function(){_.showEmboss=this.checked})),W.onchange=function(e){Q=e.target.checked,te()},H.onchange=function(e){Z=e.target.checked,ne()},$.onchange=function(e){"frequency"==e.target.value?_.toggleWave=!1:_.toggleWave=!0},te(),ne()},oe=function e(){requestAnimationFrame(e),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.toggleWave?v.getByteTimeDomainData(g):v.getByteFrequencyData(g),h.save(),h.fillStyle="black",h.globalAlpha=.3,h.fillRect(0,0,f,d),h.restore(),e.showGradient&&(h.fillStyle=y,h.fillRect(0,0,f,d)),e.showRays){e.showGradient?(h.fillStyle=y,h.globalAlpha=.1):(h.fillStyle="black",h.globalAlpha=1),h.fillRect(0,0,h.canvas.width,h.canvas.height),h.save(),h.translate(h.canvas.width/2-8,h.canvas.height/4.5-10);var t,n=w(g);try{for(n.s();!(t=n.n()).done;){var o=t.value/255;h.translate(20,0),h.rotate(2*Math.PI/30),h.save(),h.scale(1,-1),h.fillStyle=r(0,200,150,1),h.fillRect(0,0,10,100*o),h.fillRect(0,0,10,100*o),h.restore(),h.translate(5,0)}}catch(e){n.e(e)}finally{n.f()}h.restore()}if(e.showBars){var a=(f-4*(g.length-30))/g.length;h.save(),h.fillStyle="rgba(100,250,100,1)",h.strokeStyle="rgba(100,250,100,1)";for(var i=0;i<g.length;i++)h.fillRect(i*(a+4),260-g[i],a,200),h.strokeRect(i*(a+4),260-g[i],a,200);h.restore()}if(e.showLines)for(var s=0;s<10;s++){h.save(),h.strokeStyle="rgba(255,255,0,1)",h.lineWidth=3;var l=-h.canvas.width/g.length,u=h.canvas.height/2+50+1.25*s*20;h.beginPath(),h.moveTo(l,u);var p,b=w(g);try{for(b.s();!(p=b.n()).done;){var S=p.value;h.lineTo(l,u-S),l+=h.canvas.width/(g.length-40)}}catch(e){b.e(e)}finally{b.f()}h.stroke(),h.closePath(),h.restore()}if(e.showCircles){var q=d/4;h.save(),h.globalAlpha=.5;for(var k=0;k<g.length;k++){var T=g[k]/255,x=T*q;h.beginPath(),h.fillStyle=r(0,100,200,.5-T/5),h.arc(f/2,d/2,1.1*x,0,2*Math.PI,!1),h.fill(),h.closePath(),h.beginPath(),h.fillStyle=r(0,200,150,.5-T/5),h.arc(f/2,d/2,1.25*x,0,2*Math.PI,!1),h.fill(),h.closePath(),h.save(),h.beginPath(),h.fillStyle=r(0,100,250,.5-T/5),h.arc(f/2,d/2,.7*x,0,2*Math.PI,!1),h.fill(),h.closePath(),h.restore()}h.restore()}if(e.showPhyllo&&(new c(h,h.canvas.width/g.length,d/2,f,d,137.5).update(g),new c(h,h.canvas.width/g.length+f,d/2,f,d,137.5).update(g)),e.showSquares&&(e.showGradient?(h.fillStyle=y,h.globalAlpha=.1):(h.fillStyle="black",h.globalAlpha=1),new m(h,100,100,1e4/g.length,1e4/g.length,"yellow",0).update(),new m(h,600,300,1e4/g.length,1e4/g.length,"orange",0).update()),e.showNoise){for(var A=h.getImageData(0,0,f,d),P=A.data,E=P.length,I=(A.width,0);I<E;I+=4)e.showNoise&&Math.random()<.05&&(P[I]=P[I+1]=P[I+2]=255);h.putImageData(A,0,0)}if(e.showInvert){for(var L=h.getImageData(0,0,f,d),C=L.data,R=C.length,j=(L.width,0);j<R;j+=4){var M=C[j],O=C[j+1],F=C[j+2];C[j]=255-M,C[j+1]=255-O,C[j+2]=255-F}h.putImageData(L,0,0)}if(e.showEmboss){for(var B=h.getImageData(0,0,f,d),G=B.data,N=G.length,D=B.width,z=0;z<N;z++)z%4!=3&&(G[z]=127+2*G[z]-G[z+4]-G[z+4*D]);h.putImageData(B,0,0)}}(_)};window.onload=function(){console.log("window.onload called"),ee()}})();